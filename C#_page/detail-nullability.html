<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Null-Handling - Detailansicht</title>
    <link rel="stylesheet" href="unified-style.css">
</head>
<body class="detail-page">
    <div class="container">
        <a href="index.html" class="back-button">‚Üê Zur√ºck zur √úbersicht</a>

        <div class="page-header">
            <h1>‚ùì Null-Handling</h1>
            <p>Sicher mit null-Werten umgehen und NullReferenceException vermeiden</p>
        </div>

        <div class="content-section">
            <h2>üéØ Was ist null?</h2>
            <p>
                <code>null</code> bedeutet "kein Wert" oder "nicht vorhanden". Es ist ein leerer Platzhalter f√ºr Reference Types. Problematisch wird es, wenn du auf eine null-Referenz zugreifst ‚Äì das verursacht die ber√ºchtigte <code>NullReferenceException</code>.
            </p>

            <div class="warning-box">
                <div>
                    <strong>‚ö†Ô∏è NullReferenceException</strong> ist eine der h√§ufigsten Fehlerquellen in C# (und vielen anderen Sprachen). Tony Hoare, der Erfinder von null, nannte es seinen "Milliarden-Dollar-Fehler"!
                </div>
            </div>

            <pre><span class="t">string</span>? name = <span class="k">null</span>;  <span class="c">// name enth√§lt nichts</span>

<span class="c">// ‚ùå Gef√§hrlich ‚Äì wirft NullReferenceException!</span>
Console.WriteLine(name.Length);  <span class="c">// CRASH!</span>

<span class="c">// ‚úÖ Sicher</span>
Console.WriteLine(name?.Length ?? 0);  <span class="c">// 0</span></pre>
        </div>

        <div class="content-section">
            <h2>‚ùì Nullable Types</h2>
            <p>
                Mit einem <code>?</code> nach dem Typ kannst du ausdr√ºcken, dass eine Variable null sein darf.
            </p>

            <pre><span class="c">// Value Types k√∂nnen normalerweise NICHT null sein</span>
<span class="t">int</span> zahl = <span class="k">null</span>;     <span class="c">// ‚ùå Fehler!</span>

<span class="c">// Mit ? darf er null sein</span>
<span class="t">int</span>? nullableZahl = <span class="k">null</span>;   <span class="c">// ‚úÖ</span>
<span class="t">bool</span>? vielleicht = <span class="k">null</span>;    <span class="c">// ‚úÖ</span>
<span class="t">DateTime</span>? datum = <span class="k">null</span>;     <span class="c">// ‚úÖ</span>

<span class="c">// Reference Types (string, object, Klassen) k√∂nnen immer null sein</span>
<span class="c">// In modernem C# zeigst du das explizit mit ?</span>
<span class="t">string</span>? optionalerText = <span class="k">null</span>;

<span class="c">// HasValue und Value f√ºr Nullable Value Types</span>
<span class="k">if</span> (nullableZahl.HasValue)
{
    Console.WriteLine(nullableZahl.Value);  <span class="c">// Sicherer Zugriff</span>
}

<span class="c">// Oder mit GetValueOrDefault</span>
<span class="t">int</span> wert = nullableZahl.GetValueOrDefault(0);  <span class="c">// 0 wenn null</span></pre>
        </div>

        <div class="content-section">
            <h2>üîó Null-Operatoren</h2>

            <h3>‚ùì ?. ‚Äì Null-Conditional Operator</h3>
            <p>Greift nur zu, wenn das Objekt <strong>nicht null</strong> ist. Gibt sonst null zur√ºck.</p>

            <pre><span class="t">string</span>? name = <span class="k">null</span>;

<span class="c">// ‚ùå Crash wenn name null ist</span>
<span class="t">int</span> len = name.Length;

<span class="c">// ‚úÖ Gibt null zur√ºck wenn name null ist</span>
<span class="t">int</span>? len = name?.Length;   <span class="c">// null, kein Crash</span>

<span class="c">// Methoden aufrufen</span>
<span class="t">string</span>? gro√ü = name?.ToUpper();  <span class="c">// null, kein Crash</span>

<span class="c">// Verketten ‚Äì mehrere Ebenen</span>
<span class="t">string</span>? city = person?.Address?.City;  <span class="c">// null wenn person ODER Address null</span>

<span class="c">// Arrays und Indexer</span>
<span class="t">string</span>? erster = namen?[0];  <span class="c">// null wenn namen null</span></pre>

            <h3>?? ‚Äì Null-Coalescing Operator</h3>
            <p>Gibt den linken Wert zur√ºck ‚Äì oder einen Standardwert, wenn der linke null ist.</p>

            <pre><span class="t">string</span>? name = <span class="k">null</span>;

<span class="c">// Wenn name null ‚Üí "Unbekannt" verwenden</span>
<span class="t">string</span> anzeige = name ?? <span class="s">"Unbekannt"</span>;
Console.WriteLine(anzeige);  <span class="c">// "Unbekannt"</span>

<span class="c">// Kombinieren mit ?.!</span>
<span class="t">string</span> ergebnis = name?.ToUpper() ?? <span class="s">"KEIN NAME"</span>;

<span class="c">// Mehrfach verketten</span>
<span class="t">string</span> text = a ?? b ?? c ?? <span class="s">"Fallback"</span>;  <span class="c">// Erster Nicht-Null-Wert</span></pre>

            <h3>??= ‚Äì Null-Coalescing Assignment</h3>
            <p>Weist einen Wert zu ‚Äì <strong>nur wenn die Variable null ist</strong>.</p>

            <pre><span class="t">string</span>? name = <span class="k">null</span>;

<span class="c">// Traditionell</span>
<span class="k">if</span> (name == <span class="k">null</span>) name = <span class="s">"Standard"</span>;

<span class="c">// Kurzform mit ??=</span>
name ??= <span class="s">"Standard"</span>;  <span class="c">// Weist "Standard" zu, wenn name null ist</span>

<span class="c">// N√ºtzlich f√ºr Lazy Initialization</span>
<span class="k">private</span> <span class="t">List</span>&lt;<span class="t">string</span>&gt;? _items;

<span class="k">public</span> <span class="t">List</span>&lt;<span class="t">string</span>&gt; Items
{
    <span class="k">get</span> => _items ??= <span class="k">new</span> <span class="t">List</span>&lt;<span class="t">string</span>&gt;();
}</pre>
        </div>

        <div class="content-section">
            <h2>üîç Pattern Matching f√ºr Null-Checks</h2>

            <pre><span class="c">// Klassischer null-Check</span>
<span class="k">if</span> (name != <span class="k">null</span>) { ... }

<span class="c">// Modern mit Pattern Matching</span>
<span class="k">if</span> (name <span class="k">is not null</span>) { ... }  <span class="c">// Klarer lesbar</span>
<span class="k">if</span> (name <span class="k">is null</span>) { ... }

<span class="c">// Wert direkt erfassen</span>
<span class="k">if</span> (obj <span class="k">is string</span> text)
{
    Console.WriteLine(text.ToUpper());  <span class="c">// text ist string, nie null</span>
}

<span class="c">// Switch Expression mit null</span>
<span class="t">string</span> nachricht = alter <span class="k">switch</span>
{
    <span class="k">null</span> <normal>=></normal> <span class="s">"Kein Alter angegeben"</span>,
    < 0 <normal>=></normal> <span class="s">"Ung√ºltiges Alter"</span>,
    < 18 <normal>=></normal> <span class="s">"Minderj√§hrig"</span>,
    _ <normal>=></normal> <span class="s">"Erwachsen"</span>
};</pre>
        </div>

        <div class="content-section">
            <h2>‚ö° ! ‚Äì Null-Forgiving Operator</h2>
            <p>
                Sagt dem Compiler: "Ich garantiere, dass dieser Wert nicht null ist." Nur sparsam einsetzen!
            </p>

            <pre><span class="c">// Compiler warnt normalerweise hier (name k√∂nnte null sein)</span>
<span class="t">string</span>? name = GetName();
<span class="t">int</span> len = name!.Length;  <span class="c">// ! sagt: "Ich bin sicher, es ist nicht null"</span>

<span class="c">// Sinnvoller Einsatz: Nach Validierung</span>
<span class="t">string</span>? input = ReadInput();
<span class="k">if</span> (!<span class="t">string</span>.IsNullOrEmpty(input))
{
    <span class="t">int</span> len = input.Length;  <span class="c">// Kein ! n√∂tig, Compiler wei√ü es</span>
}</pre>

            <div class="warning-box">
                <div>
                    <strong>‚ö†Ô∏è Vorsicht mit !:</strong> Du umgehst damit die Null-Sicherheit des Compilers. Wenn du falsch liegst, gibt es trotzdem eine NullReferenceException zur Laufzeit!
                </div>
            </div>
        </div>

        <div class="content-section">
            <h2>‚úÖ Best Practices</h2>

            <div class="success-box">
                <div>
                    <strong>‚úÖ Gute Strategien f√ºr null-sicheren Code:</strong>
                    <ul>
                        <li>Nullable Reference Types aktivieren (<code>&lt;Nullable&gt;enable&lt;/Nullable&gt;</code> in .csproj)</li>
                        <li>Immer <code>?.Length</code> statt <code>.Length</code> wenn null m√∂glich</li>
                        <li><code>?? "Standardwert"</code> f√ºr Fallback-Werte</li>
                        <li><code>string.IsNullOrEmpty()</code> und <code>IsNullOrWhiteSpace()</code> f√ºr Strings</li>
                        <li>Fr√ºh validieren und fr√ºh zur√ºckgeben ("Guard Clause")</li>
                    </ul>
                </div>
            </div>

            <h3>üõ°Ô∏è Guard Clauses ‚Äì Fr√ºh validieren</h3>
            <pre><span class="c">// ‚ùå Tief verschachtelter Code</span>
<span class="k">public void</span> VerarbeiteBestellung(<span class="t">Bestellung</span>? bestellung)
{
    <span class="k">if</span> (bestellung != <span class="k">null</span>)
    {
        <span class="k">if</span> (bestellung.Kunde != <span class="k">null</span>)
        {
            <span class="c">// Hauptlogik hier - tief verschachtelt!</span>
        }
    }
}

<span class="c">// ‚úÖ Guard Clauses ‚Äì fr√ºh raus bei null</span>
<span class="k">public void</span> VerarbeiteBestellung(<span class="t">Bestellung</span>? bestellung)
{
    <span class="k">if</span> (bestellung <span class="k">is null</span>)
        <span class="k">throw new</span> <span class="t">ArgumentNullException</span>(<span class="k">nameof</span>(bestellung));

    <span class="k">if</span> (bestellung.Kunde <span class="k">is null</span>)
        <span class="k">throw new</span> <span class="t">InvalidOperationException</span>(<span class="s">"Bestellung ohne Kunde!"</span>);

    <span class="c">// Hauptlogik ‚Äì flach und √ºbersichtlich</span>
    SendeBest√§tigung(bestellung.Kunde);
}</pre>
        </div>

        <div class="content-section">
            <h2>üéì Zusammenfassung</h2>
            <div class="success-box">
                <div>
                    <strong>‚úÖ Was du gelernt hast:</strong>
                    <ul>
                        <li><code>?</code> nach Typ = Nullable (<code>int?</code>, <code>string?</code>)</li>
                        <li><code>?.</code> ‚Äì Null-Conditional: greift nur zu wenn nicht null</li>
                        <li><code>??</code> ‚Äì Null-Coalescing: Standardwert wenn null</li>
                        <li><code>??=</code> ‚Äì Null-Coalescing Assignment: nur zuweisen wenn null</li>
                        <li><code>is not null</code> ‚Äì Modernes Pattern Matching f√ºr Null-Checks</li>
                        <li><code>!</code> ‚Äì Null-Forgiving: nur wenn du 100% sicher bist</li>
                        <li><strong>Guard Clauses:</strong> Fr√ºh validieren, flachen Code schreiben</li>
                    </ul>
                </div>
            </div>
            <div class="info-box">
                <div>
                    <strong>‚û°Ô∏è N√§chster Schritt:</strong>
                    <p>Schau dir jetzt <strong>"Dateien & I/O"</strong> an ‚Äì wie du Dateien liest, schreibst und Verzeichnisse verwaltest!</p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
